import{r,g as m,o as w,h as q,a as e,w as u,b as d,t as I,k as O,F as T,s as z,n as K,m as Q,j as R,q as ce,d as me,v as W,x as X,y as Y,z as ve,A as Z,B as _e,p as ee,l as oe,C as ne,c as le,u as S,f as fe,D as be}from"./index-BrLNn1aF.js";import{r as B}from"./index-BA-sX6zH.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";const J=t=>(ee("data-v-5305debf"),t=t(),oe(),t),$e=J(()=>d("span",null,"生成脚本",-1)),Ve=J(()=>d("span",null,"复制链接",-1)),ye=J(()=>d("span",null,"编辑",-1)),ge=J(()=>d("span",null,"删除",-1)),xe={style:{padding:"16px"}},Ce={class:"name"},Ie={class:"edit"},we={__name:"tunnel",props:["codeInfo"],setup(t){const{codeInfo:o}=t,a=JSON.parse(localStorage.getItem(o.number))?JSON.parse(localStorage.getItem(o.number)):{},f={run:"运行",outdated:"到期",banned:"封禁"},i=r(a.name),v=r(a.type),p=r(a.localIp),b=r(a.localPort),$=r(a.remotePort),V=r(),_=r(),s=r(!1),y=r(!1),g=r(),k=r(m.runings[o.number]),h=r(),U=r(),x=r();function F(){aardio.writeFile(`/config/${o.node}-${o.number}.ini`,`
      [common] enter
      server_addr=${o.node}.mossfrp.cn enter
      server_port=${o.port} enter
      token=${o.code} enter
      [${a.name}] enter
      type=${a.type} enter
      local_ip=${a.localIp} enter
      local_port=${a.localPort} enter
      remote_port=${a.remotePort} enter
      proxy_protocol_version=${h.value?h.value:""} enter
      use_compression=${U.value?U.value:"false"} enter
      use_encryption=${x.value?x.value:"false"}
      `.replace(/\s/g,"").replace(/\enter/g,`
`))}function c(D,n){n(D),m.runings[o.number]=D,D?m.runings2.push(o.number):m.runings2.pop(o.number),D?(F(),aardio.createProc(o.node,o.number,`.\\bin\\frpc.exe -c ./config/${o.node}-${o.number}.ini`)):aardio.exitProc(o.number)}function ae(){F(),aardio.writeFile(`/script/${o.node}-${o.number}.bat`,`echo off
..\\bin\\frpc.exe -c ../config/${o.node}-${o.number}.ini`),z.success(`已生成，脚本位置：软件根目录/script/${o.node}-${o.number}.bat`)}function te(){aardio.writeText(`${o.node}.mossfrp.cn:${a.remotePort}`),z.success("已复制")}function ue(){g.value==`${o.node}-${o.number}`?B.removeCode(o.node,o.number):z.info("输入错误")}function se(){a.name=i.value,a.type=v.value,a.localIp=p.value,a.localPort=b.value,a.remotePort=$.value,localStorage.setItem(o.number,JSON.stringify(a)),y.value=!1,_.value&&(B.dateCode(o.node,o.number,_.value),_.value=""),V.value&&(B.bandCode(o.node,o.number,V.value),V.value="")}return(D,n)=>{const M=K,P=Q,L=R,de=ce,re=me,N=W,E=X,C=Y,G=ve,ie=Z,pe=_e;return w(),q(T,null,[e(re,{class:"tunnel",subtitle:`节点：${t.codeInfo.node} 可用端口：${Number(t.codeInfo.port)+1}~${Number(t.codeInfo.port)+9}`,description:`状态：${f[t.codeInfo.status]} 到期时间：${new Date(Number(t.codeInfo.stop)).toLocaleString()} 带宽：${t.codeInfo.band}Mbps`},{extra:u(()=>[e(L,null,{default:u(()=>[e(P,{type:"primary",onClick:ae,disabled:!i.value||!v.value||!p.value||!b.value||!$.value},{default:u(()=>[e(M,{name:"plus"}),$e]),_:1},8,["disabled"]),e(P,{type:"primary",onClick:te,disabled:!i.value||!v.value||!p.value||!b.value||!$.value},{default:u(()=>[e(M,{name:"content-copy"}),Ve]),_:1},8,["disabled"]),e(P,{type:"primary",onClick:n[0]||(n[0]=l=>y.value=!0)},{default:u(()=>[e(M,{name:"code-json"}),ye]),_:1}),e(P,{type:"primary",onClick:n[1]||(n[1]=l=>s.value=!0)},{default:u(()=>[e(M,{name:"trash-can-outline"}),ge]),_:1})]),_:1})]),title:u(()=>[d("div",xe,[d("span",Ce,I(i.value?i.value:"未命名"),1),e(L,{style:{display:"inline-flex"}},{default:u(()=>[e(de,{"lazy-change":"",modelValue:k.value,"onUpdate:modelValue":n[2]||(n[2]=l=>k.value=l),onBeforeChange:c,disabled:!i.value||!v.value||!p.value||!b.value||!$.value},null,8,["modelValue","disabled"]),d("span",null,I(k.value?"开":"关"),1)]),_:1})])]),_:1},8,["subtitle","description"]),e(ie,{show:y.value,"onUpdate:show":n[13]||(n[13]=l=>y.value=l)},{default:u(()=>[d("div",Ie,[d("div",null,[e(E,{placeholder:"请选择映射类型",modelValue:v.value,"onUpdate:modelValue":n[3]||(n[3]=l=>v.value=l)},{default:u(()=>[e(N,{label:"tcp"}),e(N,{label:"udp"})]),_:1},8,["modelValue"]),e(E,{placeholder:"真实IP转发",modelValue:h.value,"onUpdate:modelValue":n[4]||(n[4]=l=>h.value=l)},{default:u(()=>[e(N,{label:null}),e(N,{label:"v1"}),e(N,{label:"v2"})]),_:1},8,["modelValue"]),e(C,{modelValue:i.value,"onUpdate:modelValue":n[5]||(n[5]=l=>i.value=l),class:"nobr",placeholder:"隧道名称（英文）"},null,8,["modelValue"]),e(C,{modelValue:p.value,"onUpdate:modelValue":n[6]||(n[6]=l=>p.value=l),class:"nobr2",placeholder:"本地地址"},null,8,["modelValue"]),e(C,{modelValue:b.value,"onUpdate:modelValue":n[7]||(n[7]=l=>b.value=l),class:"nobr",placeholder:"本地端口"},null,8,["modelValue"]),e(C,{modelValue:$.value,"onUpdate:modelValue":n[8]||(n[8]=l=>$.value=l),class:"nobr2",placeholder:"远程端口"},null,8,["modelValue"]),e(C,{modelValue:V.value,"onUpdate:modelValue":n[9]||(n[9]=l=>V.value=l),class:"nobr",placeholder:"增加带宽（可空）"},null,8,["modelValue"]),e(C,{modelValue:_.value,"onUpdate:modelValue":n[10]||(n[10]=l=>_.value=l),class:"nobr2",placeholder:"续期（可空）"},null,8,["modelValue"]),e(G,{modelValue:U.value,"onUpdate:modelValue":n[11]||(n[11]=l=>U.value=l),style:{position:"absolute",left:"20px",bottom:"30px"}},{default:u(()=>[O("数据压缩")]),_:1},8,["modelValue"]),e(G,{modelValue:x.value,"onUpdate:modelValue":n[12]||(n[12]=l=>x.value=l),style:{position:"absolute",right:"20px",bottom:"30px"}},{default:u(()=>[O("数据加密")]),_:1},8,["modelValue"])]),e(P,{type:"primary",onClick:se,style:{margin:"25px","margin-left":"175px"},disabled:!i.value||!v.value||!p.value||!b.value||!$.value},{default:u(()=>[O(" 保存 ")]),_:1},8,["disabled"])])]),_:1},8,["show"]),e(pe,{show:s.value,"onUpdate:show":n[15]||(n[15]=l=>s.value=l),onConfirm:ue,title:"删除穿透码"},{default:u(()=>[d("span",null," 此操作将永久删除 "+I(t.codeInfo.node)+" 节点上的 "+I(t.codeInfo.number)+" 穿透码并返回一定量的 银币，删除后您将无法访问此穿透码所关 联的服务，且对应端口资源、带宽资源将 立即释放，此操作一经确认无法撤回哦～ ",1),d("p",null,"请输入 "+I(t.codeInfo.node)+"-"+I(t.codeInfo.number)+" 以确认",1),e(C,{modelValue:g.value,"onUpdate:modelValue":n[14]||(n[14]=l=>g.value=l)},null,8,["modelValue"])]),_:1},8,["show"])],64)}}},he=A(we,[["__scopeId","data-v-5305debf"]]),Ue={class:"tunnels"},Se={__name:"tunnels",setup(t){return(o,a)=>(w(),q("div",Ue,[(w(!0),q(T,null,ne(S(m).codeData,f=>(w(),le(he,{codeInfo:f},null,8,["codeInfo"]))),256))]))}},H=A(Se,[["__scopeId","data-v-a302d0ac"]]),j=t=>(ee("data-v-5a847ac6"),t=t(),oe(),t),ke=j(()=>d("span",null,"创建穿透码",-1)),De=j(()=>d("span",null,"刷新",-1)),Pe={id:"tunnels"},Ne={class:"createCode"},Be=j(()=>d("p",{class:"price data"},"单价：",-1)),qe=j(()=>d("p",{class:"prices data",style:{top:"150px"}},"总价：",-1)),Fe={class:"info"},Me={class:"inp"},Oe={__name:"tunnelView",setup(t){const o=r(!1),a=r(),f=r("1"),i=r("3"),v={gold:"金币",silver:"银币",mixed:"金或银币"};var p;async function b(){await B.getCodeData(),fe(H).mount("#tunnels")}function $(){let _=m.nodeData[p].price,s=m.nodeData[p].coin;be(`此操作将会消耗${_*f.value*i.value}${v[s]}`).then(y=>{y=="confirm"&&(B.createCode(p,i.value,f.value),o.value=!1)})}function V(){if(a.value!=""){p=a.value.split("-")[0];let _=m.nodeData[p].price,s=m.nodeData[p].coin;document.querySelector(".price").innerText=`单价：${_}${v[s]}`,document.querySelector(".prices").innerText=`总价：${_*f.value*i.value}${v[s]}`}}return(_,s)=>{const y=K,g=Q,k=R,h=W,U=X,x=Y,F=Z;return w(),q(T,null,[e(k,null,{default:u(()=>[e(g,{type:"primary",text:"",onClick:s[0]||(s[0]=c=>o.value=!0)},{default:u(()=>[e(y,{name:"plus"}),ke]),_:1}),e(g,{type:"primary",text:"",icon:"",onClick:b},{default:u(()=>[e(y,{name:"refresh"}),De]),_:1})]),_:1}),d("div",Pe,[e(H)]),e(F,{show:o.value,"onUpdate:show":s[4]||(s[4]=c=>o.value=c)},{default:u(()=>[d("div",Ne,[Be,qe,d("p",Fe,I(S(m).nodeData[S(p)]?S(m).nodeData[S(p)].info:null),1),d("div",Me,[e(U,{placeholder:"请选择节点",modelValue:a.value,"onUpdate:modelValue":s[1]||(s[1]=c=>a.value=c),"on-change":V},{default:u(()=>[(w(!0),q(T,null,ne(S(m).nodeData,c=>(w(),le(h,{label:c.name},null,8,["label"]))),256))]),_:1},8,["modelValue"]),e(x,{modelValue:f.value,"onUpdate:modelValue":s[2]||(s[2]=c=>f.value=c),modelModifiers:{number:!0},rules:[c=>c>0||"最低1Mbps"],placeholder:"带宽","on-change":V},null,8,["modelValue","rules"]),e(x,{modelValue:i.value,"onUpdate:modelValue":s[3]||(s[3]=c=>i.value=c),modelModifiers:{number:!0},rules:[c=>c>2||"最低3天"],placeholder:"天数","on-change":V},null,8,["modelValue","rules"]),e(g,{type:"primary",style:{width:"100px","margin-left":"30px","margin-top":"10px"},onClick:$,disabled:!a.value||!f.value||!i.value},{default:u(()=>[O(" 创建 ")]),_:1},8,["disabled"])])])]),_:1},8,["show"])],64)}}},ze=A(Oe,[["__scopeId","data-v-5a847ac6"]]);export{ze as default};
